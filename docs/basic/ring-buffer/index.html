<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    
    <meta name="description" content="Ring buffer">
    <meta name="keywords" content="ring buffer, learn, explain, tutorial, data structures, algorithms, graph, tree, interview, java, golang, kotlin, python, rust, javascript, basic level">

    <title> 
    Ring buffer
 | Practical algorithms and data structures </title>
    <link rel='stylesheet' href='/styles/styles.css'/>
</head>

<body>

<div class="rootContainer">
    <div class="horizontal-menu-box">
        
    
    
    
<div class="menu">
    <!-- ABOUT -->
    <div class="menuItem">
        
        <a href="/index.html" >
            ABOUT
        </a>
        

    </div>

    <!-- FUNDAMENTAL -->
    <div class="menuItem">
        
        <a href="/fundamental/contents" >
            FUNDAMENTAL
        </a>
        
    </div>

    <!-- BASIC -->
    <div class="menuItem">
        
        <a href="/basic/contents" >
            BASIC
        </a>
        
    </div>

    <!-- ADVANCED -->
    <div class="menuItem">
        
        <a href="/advanced/contents" >
            ADVANCED
        </a>
        
    </div>

    <!-- NINJA -->
    <div class="menuItem">

        
        <a href="/ninja/contents" >
            NINJA
        </a>
        

    </div>

    <!-- LANGUAGES -->
    <div class="menuItem">
        
        <a href="/languages/contents" >
            LANGUAGES
        </a>
        

    </div>

</div>



    </div>

    <div class="content">
        
    <h1 id="ring-buffer">Ring Buffer</h1>
<h1 id="circular-buffer">Circular buffer</h1>
<h2 id="contents">Contents</h2>
<hr />
<ul>
<li><a href="https://algoholics.io/basic/ring-buffer/#description">Ring buffer description</a></li>
<li><a href="https://algoholics.io/basic/ring-buffer/#practice">In practice</a></li>
<li><a href="https://algoholics.io/basic/ring-buffer/#java">Java</a></li>
<li><a href="https://algoholics.io/basic/ring-buffer/#go">Go</a></li>
<li><a href="https://algoholics.io/basic/ring-buffer/#python">Python</a></li>
<li><a href="https://algoholics.io/basic/ring-buffer/#javascript">JavaScript</a></li>
<li><a href="https://algoholics.io/basic/ring-buffer/#kotlin">Kotlin</a></li>
<li><a href="https://algoholics.io/basic/ring-buffer/#rust">Rust</a></li>
</ul>
<hr />
<div id="description"/>
<h2 id="description">Description</h2>
<p>see <a href="https://en.wikipedia.org/wiki/Circular_buffer">wiki page on Ring Buffer/Circular Buffer</a></p>
<div id="practice"/>
<h2 id="in-practice">In Practice</h2>
<p>Used often as fast alternative to queue based on arrays.</p>
<p>Also used when you want to see last N records, like <code>top</code> command</p>
<div id="java"/>
<h2 id="java">Java</h2>
<pre style="background-color:#2b2c2f;">
<span style="color:#c594c5;">package </span><span style="color:#cccece;">arrays</span><span style="color:#5fb3b3;">;

</span><span style="color:#c594c5;">import </span><span style="color:#fac863;">list</span><span style="color:#5fb3b3;">.</span><span style="color:#fac863;">Queue</span><span style="color:#5fb3b3;">;

</span><span style="color:#c594c5;">import </span><span style="color:#fac863;">java</span><span style="color:#5fb3b3;">.</span><span style="color:#fac863;">util</span><span style="color:#5fb3b3;">.</span><span style="color:#fac863;">ArrayList</span><span style="color:#5fb3b3;">;
</span><span style="color:#c594c5;">import </span><span style="color:#fac863;">java</span><span style="color:#5fb3b3;">.</span><span style="color:#fac863;">util</span><span style="color:#5fb3b3;">.</span><span style="color:#fac863;">Arrays</span><span style="color:#5fb3b3;">;
</span><span style="color:#c594c5;">import </span><span style="color:#fac863;">java</span><span style="color:#5fb3b3;">.</span><span style="color:#fac863;">util</span><span style="color:#5fb3b3;">.</span><span style="color:#fac863;">List</span><span style="color:#5fb3b3;">;
</span><span style="color:#c594c5;">import </span><span style="color:#fac863;">java</span><span style="color:#5fb3b3;">.</span><span style="color:#fac863;">util</span><span style="color:#5fb3b3;">.</span><span style="color:#fac863;">NoSuchElementException</span><span style="color:#5fb3b3;">;

</span><span style="color:#c594c5;">public class </span><span style="color:#fac863;">EvictingRingBuffer</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#f99157;">E</span><span style="color:#5fb3b3;">&gt; </span><span style="color:#c594c5;">implements </span><span style="color:#99c794;">Queue</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#fac863;">E</span><span style="color:#5fb3b3;">&gt; {
    </span><span style="color:#c594c5;">private final int </span><span style="color:#cccece;">maxSize</span><span style="color:#5fb3b3;">;
    </span><span style="color:#c594c5;">private final </span><span style="color:#fac863;">ArrayList</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#fac863;">E</span><span style="color:#5fb3b3;">&gt; </span><span style="color:#cccece;">container</span><span style="color:#5fb3b3;">;

    </span><span style="color:#c594c5;">private int </span><span style="color:#cccece;">writeIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">;
    </span><span style="color:#c594c5;">private int </span><span style="color:#cccece;">readIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">;
    </span><span style="color:#c594c5;">private int </span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">;

    </span><span style="color:#c594c5;">public </span><span style="color:#6699cc;">EvictingRingBuffer</span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">int </span><span style="color:#f99157;">maxSize</span><span style="color:#5fb3b3;">) {
        </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">maxSize </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> maxSize</span><span style="color:#5fb3b3;">;</span><span style="color:#cccece;">

        container </span><span style="color:#5fb3b3;">= </span><span style="color:#c594c5;">new </span><span style="color:#fac863;">ArrayList</span><span style="color:#5fb3b3;">(</span><span style="color:#fac863;">Arrays</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">asList</span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">new </span><span style="color:#fac863;">Object</span><span style="color:#5fb3b3;">[</span><span style="color:#6699cc;">maxSize</span><span style="color:#5fb3b3;">]));
    }

    @</span><span style="color:#cccece;">Override
    </span><span style="color:#c594c5;">public void </span><span style="color:#6699cc;">enqueue</span><span style="color:#5fb3b3;">(</span><span style="color:#fac863;">E </span><span style="color:#f99157;">element</span><span style="color:#5fb3b3;">) {</span><span style="color:#cccece;">
        container</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">set</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">writeIdx</span><span style="color:#5fb3b3;">,</span><span style="color:#6699cc;"> element</span><span style="color:#5fb3b3;">);</span><span style="color:#cccece;">
        writeIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#6699cc;">increment</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">writeIdx</span><span style="color:#5fb3b3;">);
        </span><span style="color:#c594c5;">if </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">==</span><span style="color:#cccece;"> maxSize</span><span style="color:#5fb3b3;">) {</span><span style="color:#cccece;">
            readIdx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> writeIdx</span><span style="color:#5fb3b3;">;
        } </span><span style="color:#c594c5;">else </span><span style="color:#5fb3b3;">{</span><span style="color:#cccece;">
            count</span><span style="color:#5fb3b3;">++;
        }
    }

    @</span><span style="color:#cccece;">Override
    </span><span style="color:#c594c5;">public </span><span style="color:#fac863;">E </span><span style="color:#6699cc;">dequeue</span><span style="color:#5fb3b3;">() </span><span style="color:#c594c5;">throws </span><span style="color:#fac863;">NoSuchElementException </span><span style="color:#5fb3b3;">{
        </span><span style="color:#c594c5;">if </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">== </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">) </span><span style="color:#c594c5;">throw new </span><span style="color:#fac863;">NoSuchElementException</span><span style="color:#5fb3b3;">();

        </span><span style="color:#fac863;">E</span><span style="color:#cccece;"> result </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> container</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">get</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">readIdx</span><span style="color:#5fb3b3;">);</span><span style="color:#cccece;">

        readIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#6699cc;">increment</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">readIdx</span><span style="color:#5fb3b3;">);</span><span style="color:#cccece;">
        count</span><span style="color:#5fb3b3;">--;

        </span><span style="color:#c594c5;">return</span><span style="color:#cccece;"> result</span><span style="color:#5fb3b3;">;
    }

    </span><span style="color:#c594c5;">public </span><span style="color:#fac863;">List</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#fac863;">E</span><span style="color:#5fb3b3;">&gt; </span><span style="color:#6699cc;">elements</span><span style="color:#5fb3b3;">() {
        </span><span style="color:#fac863;">List</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#fac863;">E</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;"> result </span><span style="color:#5fb3b3;">= </span><span style="color:#c594c5;">new </span><span style="color:#fac863;">ArrayList</span><span style="color:#5fb3b3;">&lt;&gt;(</span><span style="color:#cccece;">maxSize</span><span style="color:#5fb3b3;">);

        </span><span style="color:#c594c5;">int</span><span style="color:#cccece;"> curIdx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> readIdx</span><span style="color:#5fb3b3;">;
        </span><span style="color:#c594c5;">for </span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">int</span><span style="color:#cccece;"> i </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">;</span><span style="color:#cccece;"> i </span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;"> count</span><span style="color:#5fb3b3;">;</span><span style="color:#cccece;"> curIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#6699cc;">increment</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">curIdx</span><span style="color:#5fb3b3;">)</span><span style="color:#cccece;">, i</span><span style="color:#5fb3b3;">++) {</span><span style="color:#cccece;">
            result</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">container</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">get</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">curIdx</span><span style="color:#5fb3b3;">));
        }
        </span><span style="color:#c594c5;">return</span><span style="color:#cccece;"> result</span><span style="color:#5fb3b3;">;
    }

    </span><span style="color:#c594c5;">private int </span><span style="color:#6699cc;">increment</span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">int </span><span style="color:#f99157;">idx</span><span style="color:#5fb3b3;">) {
        </span><span style="color:#c594c5;">return </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">idx </span><span style="color:#5fb3b3;">+ </span><span style="color:#f99157;">1</span><span style="color:#5fb3b3;">) %</span><span style="color:#cccece;"> container</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">size</span><span style="color:#5fb3b3;">();
    }

}

</span></pre><div id="go"/>
<h2 id="go">Go</h2>
<pre style="background-color:#2b2c2f;">
<span style="color:#c594c5;">package</span><span style="color:#cccece;"> arrays

</span><span style="color:#c594c5;">type </span><span style="color:#cccece;">RingBuffer </span><span style="color:#c594c5;">struct </span><span style="color:#5fb3b3;">{
	</span><span style="color:#cccece;">container </span><span style="color:#5fb3b3;">[]</span><span style="color:#c594c5;">interface</span><span style="color:#5fb3b3;">{}
	</span><span style="color:#cccece;">readIdx   </span><span style="color:#c594c5;">int
	</span><span style="color:#cccece;">writeIdx  </span><span style="color:#c594c5;">int
	</span><span style="color:#cccece;">count     </span><span style="color:#c594c5;">int
	</span><span style="color:#cccece;">max       </span><span style="color:#c594c5;">int
</span><span style="color:#5fb3b3;">}

</span><span style="color:#c594c5;">func </span><span style="color:#6699cc;">NewRingBuffer</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">maxSize </span><span style="color:#c594c5;">int</span><span style="color:#5fb3b3;">) *</span><span style="color:#cccece;">RingBuffer </span><span style="color:#5fb3b3;">{
	</span><span style="color:#cccece;">buf </span><span style="color:#5fb3b3;">:= </span><span style="color:#6699cc;">new</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">RingBuffer</span><span style="color:#5fb3b3;">)</span><span style="color:#cccece;">
	buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">max </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> maxSize
	buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container </span><span style="color:#5fb3b3;">= </span><span style="color:#6699cc;">make</span><span style="color:#5fb3b3;">([]</span><span style="color:#c594c5;">interface</span><span style="color:#5fb3b3;">{},</span><span style="color:#6699cc;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">max</span><span style="color:#5fb3b3;">)
	</span><span style="color:#c594c5;">return</span><span style="color:#cccece;"> buf
</span><span style="color:#5fb3b3;">}

</span><span style="color:#c594c5;">func </span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">buf </span><span style="color:#5fb3b3;">*</span><span style="color:#cccece;">RingBuffer</span><span style="color:#5fb3b3;">) </span><span style="color:#6699cc;">Dequeue</span><span style="color:#5fb3b3;">() (</span><span style="color:#cccece;">elem </span><span style="color:#c594c5;">interface</span><span style="color:#5fb3b3;">{},</span><span style="color:#cccece;"> ok </span><span style="color:#c594c5;">bool</span><span style="color:#5fb3b3;">) {</span><span style="color:#cccece;">
	ok </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">true
	</span><span style="color:#c594c5;">if</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">== </span><span style="color:#f99157;">0 </span><span style="color:#5fb3b3;">{
		</span><span style="color:#c594c5;">return </span><span style="color:#f99157;">nil</span><span style="color:#5fb3b3;">, </span><span style="color:#f99157;">false
	</span><span style="color:#5fb3b3;">}</span><span style="color:#cccece;">
	elem </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container</span><span style="color:#5fb3b3;">[</span><span style="color:#cccece;">buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx</span><span style="color:#5fb3b3;">]</span><span style="color:#cccece;">

	buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">nextIdx</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx</span><span style="color:#5fb3b3;">)</span><span style="color:#cccece;">
	buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count</span><span style="color:#5fb3b3;">--
	</span><span style="color:#c594c5;">return
</span><span style="color:#5fb3b3;">}

</span><span style="color:#c594c5;">func </span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">buf </span><span style="color:#5fb3b3;">*</span><span style="color:#cccece;">RingBuffer</span><span style="color:#5fb3b3;">) </span><span style="color:#6699cc;">Enqueue</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">elem </span><span style="color:#c594c5;">interface</span><span style="color:#5fb3b3;">{}) {</span><span style="color:#cccece;">
	buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container</span><span style="color:#5fb3b3;">[</span><span style="color:#cccece;">buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">writeIdx</span><span style="color:#5fb3b3;">] =</span><span style="color:#cccece;"> elem
	buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">writeIdx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">nextIdx</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">writeIdx</span><span style="color:#5fb3b3;">)
	</span><span style="color:#c594c5;">if</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">==</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">max </span><span style="color:#5fb3b3;">{</span><span style="color:#cccece;">
		buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">writeIdx
	</span><span style="color:#5fb3b3;">} </span><span style="color:#c594c5;">else </span><span style="color:#5fb3b3;">{</span><span style="color:#cccece;">
		buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count</span><span style="color:#5fb3b3;">++
	}
}

</span><span style="color:#c594c5;">func </span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">buf </span><span style="color:#5fb3b3;">*</span><span style="color:#cccece;">RingBuffer</span><span style="color:#5fb3b3;">) </span><span style="color:#6699cc;">Elements</span><span style="color:#5fb3b3;">() (</span><span style="color:#cccece;">result </span><span style="color:#5fb3b3;">[]</span><span style="color:#c594c5;">interface</span><span style="color:#5fb3b3;">{}) {</span><span style="color:#cccece;">
	result </span><span style="color:#5fb3b3;">= </span><span style="color:#6699cc;">make</span><span style="color:#5fb3b3;">([]</span><span style="color:#c594c5;">interface</span><span style="color:#5fb3b3;">{}, </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">,</span><span style="color:#6699cc;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">max</span><span style="color:#5fb3b3;">)

	</span><span style="color:#cccece;">curReadIdx </span><span style="color:#5fb3b3;">:=</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx
	</span><span style="color:#c594c5;">for </span><span style="color:#cccece;">i </span><span style="color:#5fb3b3;">:= </span><span style="color:#f99157;">0</span><span style="color:#cccece;">; i </span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count; i</span><span style="color:#5fb3b3;">++ {</span><span style="color:#cccece;">
		result </span><span style="color:#5fb3b3;">= </span><span style="color:#6699cc;">append</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">result</span><span style="color:#5fb3b3;">,</span><span style="color:#6699cc;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container</span><span style="color:#5fb3b3;">[</span><span style="color:#6699cc;">curReadIdx</span><span style="color:#5fb3b3;">])</span><span style="color:#cccece;">
		curReadIdx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">nextIdx</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">curReadIdx</span><span style="color:#5fb3b3;">)
	}
	</span><span style="color:#c594c5;">return
</span><span style="color:#5fb3b3;">}

</span><span style="color:#c594c5;">func </span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">buf </span><span style="color:#5fb3b3;">*</span><span style="color:#cccece;">RingBuffer</span><span style="color:#5fb3b3;">) </span><span style="color:#6699cc;">nextIdx</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">curIdx </span><span style="color:#c594c5;">int</span><span style="color:#5fb3b3;">) </span><span style="color:#c594c5;">int </span><span style="color:#5fb3b3;">{
	</span><span style="color:#c594c5;">return </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">curIdx </span><span style="color:#5fb3b3;">+ </span><span style="color:#f99157;">1</span><span style="color:#5fb3b3;">) %</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">max
</span><span style="color:#5fb3b3;">}

</span></pre><div id="python"/>
<h2 id="python">Python</h2>
<pre style="background-color:#2b2c2f;">
<span style="color:#c594c5;">class </span><span style="color:#fac863;">RingBuffer</span><span style="color:#5fb3b3;">:
    </span><span style="color:#c594c5;">def </span><span style="color:#6699cc;">__init__</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">self</span><span style="color:#5fb3b3;">, </span><span style="color:#f99157;">input_capacity</span><span style="color:#5fb3b3;">):
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">max_size </span><span style="color:#5fb3b3;">= </span><span style="color:#cccece;">input_capacity
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container </span><span style="color:#5fb3b3;">= [</span><span style="color:#f99157;">None</span><span style="color:#5fb3b3;">] * </span><span style="color:#cccece;">input_capacity
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">write_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0

    </span><span style="color:#c594c5;">def </span><span style="color:#6699cc;">enqueue</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">self</span><span style="color:#5fb3b3;">, </span><span style="color:#f99157;">in_element</span><span style="color:#5fb3b3;">):
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container</span><span style="color:#5fb3b3;">[</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">write_idx</span><span style="color:#5fb3b3;">] = </span><span style="color:#cccece;">in_element
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">write_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">_next_idx</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">write_idx</span><span style="color:#5fb3b3;">)
        </span><span style="color:#c594c5;">if </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">== </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">max_size</span><span style="color:#5fb3b3;">:
            </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">write_idx
        </span><span style="color:#c594c5;">else</span><span style="color:#5fb3b3;">:
            </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">+ </span><span style="color:#f99157;">1

    </span><span style="color:#c594c5;">def </span><span style="color:#6699cc;">dequeue</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">self</span><span style="color:#5fb3b3;">):
        </span><span style="color:#cccece;">result </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container</span><span style="color:#5fb3b3;">[</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx</span><span style="color:#5fb3b3;">]

        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">_next_idx</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">read_idx</span><span style="color:#5fb3b3;">)
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">- </span><span style="color:#f99157;">1

        </span><span style="color:#c594c5;">return </span><span style="color:#cccece;">result

    </span><span style="color:#c594c5;">def </span><span style="color:#6699cc;">elements</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">self</span><span style="color:#5fb3b3;">):
        </span><span style="color:#cccece;">result </span><span style="color:#5fb3b3;">= []
        </span><span style="color:#cccece;">cur_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx
        </span><span style="color:#c594c5;">for </span><span style="color:#cccece;">i </span><span style="color:#c594c5;">in </span><span style="color:#6699cc;">range</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">, </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">count</span><span style="color:#5fb3b3;">):
            </span><span style="color:#6699cc;">result</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">append</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">container</span><span style="color:#5fb3b3;">[</span><span style="color:#6699cc;">cur_idx</span><span style="color:#5fb3b3;">])
            </span><span style="color:#cccece;">cur_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">_next_idx</span><span style="color:#5fb3b3;">(</span><span style="color:#6699cc;">cur_idx</span><span style="color:#5fb3b3;">)
        </span><span style="color:#c594c5;">return </span><span style="color:#cccece;">result

    </span><span style="color:#c594c5;">def </span><span style="color:#6699cc;">_next_idx</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">self</span><span style="color:#5fb3b3;">, </span><span style="color:#f99157;">cur_idx</span><span style="color:#5fb3b3;">):
        </span><span style="color:#c594c5;">return </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">cur_idx </span><span style="color:#5fb3b3;">+ </span><span style="color:#f99157;">1</span><span style="color:#5fb3b3;">) % </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">max_size

</span></pre><div id="javascript"/>
<h2 id="javascript">JavaScript</h2>
<pre style="background-color:#2b2c2f;">
<span style="color:#c594c5;">class </span><span style="color:#fac863;">RingBuffer </span><span style="color:#5fb3b3;">{
  </span><span style="color:#6699cc;">constructor</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">capacity</span><span style="color:#5fb3b3;">) {   
    </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container </span><span style="color:#5fb3b3;">= </span><span style="color:#fac863;">Array</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">capacity</span><span style="color:#5fb3b3;">).</span><span style="color:#6699cc;">fill</span><span style="color:#5fb3b3;">({})
    </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0
    </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">writeIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0
    </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0
    </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">maxSize </span><span style="color:#5fb3b3;">= </span><span style="color:#cccece;">capacity
  </span><span style="color:#5fb3b3;">}

  </span><span style="color:#6699cc;">enqueue</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">element</span><span style="color:#5fb3b3;">) {
    </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container</span><span style="color:#5fb3b3;">[</span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">writeIdx</span><span style="color:#5fb3b3;">] = </span><span style="color:#cccece;">element
    </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">writeIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">nextIdx</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">writeIdx</span><span style="color:#5fb3b3;">)
    </span><span style="color:#c594c5;">if </span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count </span><span style="color:#5fb3b3;">=== </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">maxSize</span><span style="color:#5fb3b3;">) {
      </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">writeIdx
    </span><span style="color:#5fb3b3;">} </span><span style="color:#c594c5;">else </span><span style="color:#5fb3b3;">{
      </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count</span><span style="color:#5fb3b3;">++
    }
  }

  </span><span style="color:#6699cc;">dequeue</span><span style="color:#5fb3b3;">() {
    </span><span style="color:#c594c5;">const </span><span style="color:#cccece;">result </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">container</span><span style="color:#5fb3b3;">[</span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx</span><span style="color:#5fb3b3;">]

    </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">nextIdx</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">readIdx</span><span style="color:#5fb3b3;">)
    </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count</span><span style="color:#5fb3b3;">--

    </span><span style="color:#c594c5;">return </span><span style="color:#cccece;">result
  </span><span style="color:#5fb3b3;">}

  </span><span style="color:#6699cc;">elements</span><span style="color:#5fb3b3;">() {
    </span><span style="color:#c594c5;">const </span><span style="color:#cccece;">result </span><span style="color:#5fb3b3;">= []
    </span><span style="color:#c594c5;">let </span><span style="color:#cccece;">curIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">readIdx 
    </span><span style="color:#c594c5;">for </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">i </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">; </span><span style="color:#cccece;">i </span><span style="color:#5fb3b3;">&lt; </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">count</span><span style="color:#5fb3b3;">; </span><span style="color:#cccece;">i</span><span style="color:#5fb3b3;">++) {
      </span><span style="color:#cccece;">result</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">push</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">container</span><span style="color:#5fb3b3;">[</span><span style="color:#cccece;">curIdx</span><span style="color:#5fb3b3;">])
      </span><span style="color:#cccece;">curIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">nextIdx</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">curIdx</span><span style="color:#5fb3b3;">)
    }
    </span><span style="color:#c594c5;">return </span><span style="color:#cccece;">result
  </span><span style="color:#5fb3b3;">}

  </span><span style="color:#6699cc;">nextIdx</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">idx</span><span style="color:#5fb3b3;">) {
    </span><span style="color:#c594c5;">return </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">idx </span><span style="color:#5fb3b3;">+ </span><span style="color:#f99157;">1</span><span style="color:#5fb3b3;">) % </span><span style="color:#ec5f67;">this</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">maxSize    
  </span><span style="color:#5fb3b3;">}
}
</span></pre><div id="kotlin"/>
<h2 id="kotlin">Kotlin</h2>
<pre style="background-color:#2b2c2f;">
<span style="color:#c594c5;">package </span><span style="color:#cccece;">arrays

class EvictingRingBuffer&lt;T&gt;(</span><span style="color:#c594c5;">val</span><span style="color:#cccece;"> maxSize</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">Int</span><span style="color:#cccece;">) {
    </span><span style="color:#c594c5;">private val </span><span style="color:#cccece;">container</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">Array</span><span style="color:#cccece;">&lt;T&gt; </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> arrayOfNulls&lt;</span><span style="color:#c594c5;">Any</span><span style="color:#cccece;">?&gt;(maxSize) </span><span style="color:#5fb3b3;">as </span><span style="color:#c594c5;">Array</span><span style="color:#cccece;">&lt;T&gt;
    </span><span style="color:#c594c5;">private var </span><span style="color:#cccece;">elementsCount </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0
    </span><span style="color:#c594c5;">private var </span><span style="color:#cccece;">writeIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0
    </span><span style="color:#c594c5;">private var </span><span style="color:#cccece;">readIdx </span><span style="color:#5fb3b3;">= </span><span style="color:#f99157;">0

    </span><span style="color:#c594c5;">fun </span><span style="color:#6699cc;">enqueue</span><span style="color:#cccece;">(</span><span style="color:#f99157;">element</span><span style="color:#5fb3b3;">:</span><span style="color:#cccece;"> T) {
        container[writeIdx] </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> element
        writeIdx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> incrementIdx(writeIdx)
        </span><span style="color:#c594c5;">if</span><span style="color:#cccece;"> (elementsCount </span><span style="color:#5fb3b3;">==</span><span style="color:#cccece;"> maxSize) {
            readIdx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> writeIdx
        } </span><span style="color:#c594c5;">else</span><span style="color:#cccece;"> {
            elementsCount</span><span style="color:#5fb3b3;">++</span><span style="color:#cccece;">
        }
    }

    </span><span style="color:#c594c5;">fun </span><span style="color:#6699cc;">dequeue</span><span style="color:#cccece;">()</span><span style="color:#5fb3b3;">:</span><span style="color:#cccece;"> T {
        require(elementsCount </span><span style="color:#5fb3b3;">&gt; </span><span style="color:#f99157;">0</span><span style="color:#cccece;">) { </span><span style="color:#5fb3b3;">&quot;</span><span style="color:#99c794;">buffer is empty</span><span style="color:#5fb3b3;">&quot;</span><span style="color:#cccece;"> }

        </span><span style="color:#c594c5;">val </span><span style="color:#cccece;">element </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> container[readIdx]
        elementsCount</span><span style="color:#5fb3b3;">--</span><span style="color:#cccece;">
        readIdx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> incrementIdx(readIdx)

        </span><span style="color:#c594c5;">return</span><span style="color:#cccece;"> element
    }

    </span><span style="color:#c594c5;">fun </span><span style="color:#6699cc;">elements</span><span style="color:#cccece;">()</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">Array</span><span style="color:#cccece;">&lt;T&gt; {
        </span><span style="color:#c594c5;">val </span><span style="color:#cccece;">result</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">Array</span><span style="color:#cccece;">&lt;T&gt; </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> arrayOfNulls&lt;</span><span style="color:#c594c5;">Any</span><span style="color:#cccece;">?&gt;(elementsCount) </span><span style="color:#5fb3b3;">as </span><span style="color:#c594c5;">Array</span><span style="color:#cccece;">&lt;T&gt;
        </span><span style="color:#c594c5;">var </span><span style="color:#cccece;">idx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> readIdx
        </span><span style="color:#c594c5;">for</span><span style="color:#cccece;"> (i </span><span style="color:#c594c5;">in </span><span style="color:#f99157;">0</span><span style="color:#cccece;"> until elementsCount) {
            result[i] </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> container[idx]
            idx </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> incrementIdx(idx)
        }
        </span><span style="color:#c594c5;">return</span><span style="color:#cccece;"> result
    }

    </span><span style="color:#c594c5;">private fun </span><span style="color:#6699cc;">incrementIdx</span><span style="color:#cccece;">(</span><span style="color:#f99157;">idx</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">Int</span><span style="color:#cccece;">)</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">Int</span><span style="color:#cccece;"> {
        </span><span style="color:#c594c5;">return</span><span style="color:#cccece;"> (idx </span><span style="color:#5fb3b3;">+ </span><span style="color:#f99157;">1</span><span style="color:#cccece;">) </span><span style="color:#5fb3b3;">%</span><span style="color:#cccece;"> maxSize
    }
}
</span></pre><div id="rust"/>
<h2 id="rust">Rust</h2>
<pre style="background-color:#2b2c2f;">
<span style="color:#c594c5;">pub struct </span><span style="color:#cccece;">EvictingRingBuffer</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#c594c5;">&#39;a</span><span style="color:#cccece;">, T</span><span style="color:#5fb3b3;">&gt; {
    </span><span style="color:#cccece;">buff</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Vec</span><span style="color:#5fb3b3;">&lt;&amp;</span><span style="color:#c594c5;">&#39;a</span><span style="color:#cccece;"> T</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">,
    write_idx</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">usize</span><span style="color:#cccece;">,
    read_idx</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">usize</span><span style="color:#cccece;">,
    size</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">usize</span><span style="color:#cccece;">,
    capacity</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">usize</span><span style="color:#cccece;">,
</span><span style="color:#5fb3b3;">}

</span><span style="color:#c594c5;">impl</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#c594c5;">&#39;a</span><span style="color:#cccece;">, T</span><span style="color:#5fb3b3;">&gt; </span><span style="color:#cccece;">EvictingRingBuffer</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#c594c5;">&#39;a</span><span style="color:#cccece;">, T</span><span style="color:#5fb3b3;">&gt; {
    </span><span style="color:#c594c5;">pub fn </span><span style="color:#6699cc;">new</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">capacity</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">usize</span><span style="color:#5fb3b3;">) -&gt; </span><span style="color:#c594c5;">Self </span><span style="color:#5fb3b3;">{
        </span><span style="color:#c594c5;">let</span><span style="color:#cccece;"> buff</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Vec</span><span style="color:#5fb3b3;">&lt;&amp;</span><span style="color:#c594c5;">&#39;a</span><span style="color:#cccece;"> T</span><span style="color:#5fb3b3;">&gt; = </span><span style="color:#fac863;">Vec</span><span style="color:#5fb3b3;">::</span><span style="color:#cccece;">with_capacity</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">capacity</span><span style="color:#5fb3b3;">);</span><span style="color:#cccece;">
        EvictingRingBuffer </span><span style="color:#5fb3b3;">{</span><span style="color:#cccece;"> buff</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> write_idx</span><span style="color:#5fb3b3;">: </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> read_idx</span><span style="color:#5fb3b3;">: </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> size</span><span style="color:#5fb3b3;">: </span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> capacity </span><span style="color:#5fb3b3;">}
    }

    </span><span style="color:#c594c5;">pub fn </span><span style="color:#6699cc;">push</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">self</span><span style="color:#cccece;">, </span><span style="color:#f99157;">value</span><span style="color:#5fb3b3;">: &amp;</span><span style="color:#c594c5;">&#39;a</span><span style="color:#cccece;"> T</span><span style="color:#5fb3b3;">) {
        </span><span style="color:#c594c5;">if let </span><span style="color:#fac863;">Some</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">existing</span><span style="color:#5fb3b3;">) = </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">buff</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">get_mut</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">write_idx</span><span style="color:#5fb3b3;">) {
            *</span><span style="color:#cccece;">existing </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> value</span><span style="color:#5fb3b3;">;
        } </span><span style="color:#c594c5;">else </span><span style="color:#5fb3b3;">{
            </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">buff</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">insert</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">write_idx</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> value</span><span style="color:#5fb3b3;">);
        }

        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">write_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">next_idx</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">write_idx</span><span style="color:#5fb3b3;">);

        </span><span style="color:#c594c5;">if </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">size </span><span style="color:#5fb3b3;">== </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">capacity </span><span style="color:#5fb3b3;">{
            </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">next_idx</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx</span><span style="color:#5fb3b3;">);
        } </span><span style="color:#c594c5;">else </span><span style="color:#5fb3b3;">{
            </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">size </span><span style="color:#5fb3b3;">+= </span><span style="color:#f99157;">1</span><span style="color:#5fb3b3;">;
        }
    }

    </span><span style="color:#c594c5;">pub fn </span><span style="color:#6699cc;">take</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">self</span><span style="color:#5fb3b3;">) -&gt; </span><span style="color:#cccece;">Option</span><span style="color:#5fb3b3;">&lt;&amp;&amp;</span><span style="color:#c594c5;">&#39;a</span><span style="color:#cccece;"> T</span><span style="color:#5fb3b3;">&gt; {
        </span><span style="color:#c594c5;">if </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">size </span><span style="color:#5fb3b3;">== </span><span style="color:#f99157;">0 </span><span style="color:#5fb3b3;">{
            </span><span style="color:#c594c5;">return </span><span style="color:#fac863;">None</span><span style="color:#5fb3b3;">;
        }
        </span><span style="color:#c594c5;">let</span><span style="color:#cccece;"> result </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">buff</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">get</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx</span><span style="color:#5fb3b3;">);
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx </span><span style="color:#5fb3b3;">= </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">next_idx</span><span style="color:#5fb3b3;">(</span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">read_idx</span><span style="color:#5fb3b3;">);
        </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">size </span><span style="color:#5fb3b3;">-= </span><span style="color:#f99157;">1</span><span style="color:#5fb3b3;">;</span><span style="color:#cccece;">

        result
    </span><span style="color:#5fb3b3;">}

    </span><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">next_idx</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#f99157;">self</span><span style="color:#cccece;">, </span><span style="color:#f99157;">idx</span><span style="color:#5fb3b3;">: </span><span style="color:#c594c5;">usize</span><span style="color:#5fb3b3;">) -&gt; </span><span style="color:#c594c5;">usize </span><span style="color:#5fb3b3;">{
        (</span><span style="color:#cccece;">idx </span><span style="color:#5fb3b3;">+ </span><span style="color:#f99157;">1</span><span style="color:#5fb3b3;">) % </span><span style="color:#ec5f67;">self</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">capacity
    </span><span style="color:#5fb3b3;">}
}

#[</span><span style="color:#cccece;">test</span><span style="color:#5fb3b3;">]
</span><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">test</span><span style="color:#5fb3b3;">() {
    </span><span style="color:#c594c5;">let mut</span><span style="color:#cccece;"> buf</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">EvictingRingBuffer</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#c594c5;">i32</span><span style="color:#5fb3b3;">&gt; = </span><span style="color:#cccece;">EvictingRingBuffer</span><span style="color:#5fb3b3;">::</span><span style="color:#cccece;">new</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">3</span><span style="color:#5fb3b3;">);

    </span><span style="color:#cccece;">assert_eq!</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">take</span><span style="color:#5fb3b3;">(), </span><span style="color:#fac863;">None</span><span style="color:#5fb3b3;">);</span><span style="color:#cccece;">

    buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">push</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#f99157;">1</span><span style="color:#5fb3b3;">);</span><span style="color:#cccece;">
    buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">push</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#f99157;">2</span><span style="color:#5fb3b3;">);</span><span style="color:#cccece;">
    buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">push</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#f99157;">3</span><span style="color:#5fb3b3;">);</span><span style="color:#cccece;">
    buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">push</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#f99157;">4</span><span style="color:#5fb3b3;">);</span><span style="color:#cccece;">
    buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">push</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#f99157;">5</span><span style="color:#5fb3b3;">);

    </span><span style="color:#cccece;">assert_eq!</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">take</span><span style="color:#5fb3b3;">(), </span><span style="color:#fac863;">Some</span><span style="color:#5fb3b3;">(&amp;&amp;</span><span style="color:#f99157;">3</span><span style="color:#5fb3b3;">));
    </span><span style="color:#cccece;">assert_eq!</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">take</span><span style="color:#5fb3b3;">(), </span><span style="color:#fac863;">Some</span><span style="color:#5fb3b3;">(&amp;&amp;</span><span style="color:#f99157;">4</span><span style="color:#5fb3b3;">));
    </span><span style="color:#cccece;">assert_eq!</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">take</span><span style="color:#5fb3b3;">(), </span><span style="color:#fac863;">Some</span><span style="color:#5fb3b3;">(&amp;&amp;</span><span style="color:#f99157;">5</span><span style="color:#5fb3b3;">));
    </span><span style="color:#cccece;">assert_eq!</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">buf</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">take</span><span style="color:#5fb3b3;">(), </span><span style="color:#fac863;">None</span><span style="color:#5fb3b3;">);
}
</span></pre>

    </div>

</div>

</body>
</html>
